<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Champion 4D Analysis - LoL Item Quiz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #0066cc;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        .viz-container {
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #dee2e6;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .instructions {
            margin: 20px 0;
            padding: 15px;
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            border-radius: 5px;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #1976d2;
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .legend-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            border-left: 3px solid #28a745;
        }
        
        .back-link {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
        }
        
        .back-link:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>⚔️ LoL Champions 4D Analysis</h1>
            <div class="subtitle">暇人ゲーマーのための171チャンピオンマッピング</div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">171</div>
                    <div class="stat-label">チャンピオン</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4</div>
                    <div class="stat-label">指標分析</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">6</div>
                    <div class="stat-label">プライマリロール</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15.14</div>
                    <div class="stat-label">パッチバージョン</div>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <h3>🎮 操作方法</h3>
            <ul>
                <li><strong>マウスドラッグ</strong>: 3D視点を回転</li>
                <li><strong>スクロール</strong>: ズームイン/アウト</li>
                <li><strong>ホバー</strong>: チャンピオン詳細情報表示</li>
                <li><strong>ダブルクリック</strong>: オートフィット</li>
            </ul>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <strong>🗺️ 座標軸</strong><br>
                X軸: ⚔️ Attack Power<br>
                Y軸: 🔮 Magic Power<br>
                Z軸: 🛡️ Defense
            </div>
            <div class="legend-item">
                <strong>🎨 色情報</strong><br>
                紫→緑→黄: 難易度レベル<br>
                暗い色 = 簡単<br>
                明るい色 = 困難
            </div>
            <div class="legend-item">
                <strong>📊 発見ポイント</strong><br>
                • タンクは高いZ軸（Defense）<br>
                • メイジは高いY軸（Magic）<br>
                • ADCは高いX軸（Attack）
            </div>
        </div>
        
        <div class="viz-container">
            <div id="champion-viz-plot" style="width:100%;height:700px;"></div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; color: #666;">
            <p>📊 Data Source: Riot Games Data Dragon API | 🎮 For Educational Purpose Only</p>
        </div>
        
        <a href="/etc" class="back-link">← etcページに戻る</a>
    </div>
    
    <script>
        // Champion data fetch and visualization
        fetch('https://ddragon.leagueoflegends.com/cdn/15.14.1/data/en_US/championFull.json')
            .then(response => response.json())
            .then(data => {
                const champions = [];
                
                for (const [key, champion] of Object.entries(data.data)) {
                    champions.push({
                        name: champion.name,
                        title: champion.title,
                        attack: champion.info.attack,
                        defense: champion.info.defense,
                        magic: champion.info.magic,
                        difficulty: champion.info.difficulty,
                        tags: champion.tags
                    });
                }
                
                createVisualization(champions);
            })
            .catch(error => {
                console.error('Error fetching champion data:', error);
                document.getElementById('champion-viz-plot').innerHTML = 
                    '<div style="text-align:center;padding:50px;color:#666;">データの読み込みに失敗しました。しばらく待ってからリロードしてください。</div>';
            });
        
        function createVisualization(champions) {
            const trace = {
                x: champions.map(c => c.attack),
                y: champions.map(c => c.magic),
                z: champions.map(c => c.defense),
                mode: 'markers',
                marker: {
                    size: 6,
                    color: champions.map(c => c.difficulty),
                    colorscale: 'Viridis',
                    colorbar: {
                        title: 'Difficulty Level',
                        titleside: 'right'
                    },
                    line: {
                        color: 'rgba(255, 255, 255, 0.3)',
                        width: 0.5
                    }
                },
                text: champions.map(c => 
                    `<b>${c.name}</b><br>` +
                    `Title: ${c.title}<br>` +
                    `Role: ${c.tags[0] || 'Unknown'}<br>` +
                    `⚔️ Attack: ${c.attack}<br>` +
                    `🔮 Magic: ${c.magic}<br>` +
                    `🛡️ Defense: ${c.defense}<br>` +
                    `📊 Difficulty: ${c.difficulty}`
                ),
                hovertemplate: '%{text}<extra></extra>',
                type: 'scatter3d'
            };
            
            const layout = {
                title: {
                    text: '⚔️ LoL Champions 4D Battle Map',
                    x: 0.5,
                    font: { size: 20 }
                },
                scene: {
                    xaxis: { title: '⚔️ Attack Power' },
                    yaxis: { title: '🔮 Magic Power' },
                    zaxis: { title: '🛡️ Defense' },
                    bgcolor: 'rgba(240, 240, 240, 0.8)',
                    camera: {
                        eye: { x: 1.5, y: 1.5, z: 1.5 }
                    }
                },
                width: undefined,
                height: 700,
                margin: { l: 0, r: 0, b: 0, t: 60 }
            };
            
            const config = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['pan2d', 'select2d', 'lasso2d']
            };
            
            Plotly.newPlot('champion-viz-plot', [trace], layout, config);
        }
    </script>
</body>
</html>